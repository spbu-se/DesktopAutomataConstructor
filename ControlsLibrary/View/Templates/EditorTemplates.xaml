<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:controls="http://schemas.panthernet.ru/graphx/"
                    xmlns:po="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
                    xmlns:language="clr-namespace:ControlsLibrary.Properties.Langs"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <SolidColorBrush x:Key="EdgeArrowBrush" Color="Black" po:Freeze="true" />

    <DrawingImage x:Key="selfLoopedIndicator">
        <DrawingImage.Drawing>
            <DrawingGroup ClipGeometry="M0,0 V5.2916667 H5.2916667 V0 H0 Z">
                <DrawingGroup Opacity="1">
                    <DrawingGroup Opacity="1" Transform="1,0,0,1,-1.984375,-1.1103051">
                        <GeometryDrawing Geometry="F0 M5.2916667,5.2916667z M0,0z M3.8616831,5.9747834A1.1191912,2.2049735,0,0,1,4.1902343,3.0550256A1.1191912,2.2049735,0,0,1,5.6938085,3.4660738A1.1191912,2.2049735,0,0,1,5.6064274,6.451763">
                            <GeometryDrawing.Pen>
                                <Pen Brush="#FF000000" Thickness="0.132292" StartLineCap="Flat" EndLineCap="Flat" LineJoin="Miter" />
                            </GeometryDrawing.Pen>
                        </GeometryDrawing>
                        <DrawingGroup Transform="0.58287604,0.12660212,-0.14552687,0.50707709,3.1732333,3.8465829">
                            <GeometryDrawing Brush="#FF030000" Geometry="F1 M5.2916667,5.2916667z M0,0z M1.0651849,3.2972248L2.5603007,2.9222117 2.1375137,4.4045266z" />
                        </DrawingGroup>
                    </DrawingGroup>
                </DrawingGroup>
            </DrawingGroup>
        </DrawingImage.Drawing>
    </DrawingImage>

    <DrawingImage x:Key="penDrawingImage">
        <DrawingImage.Drawing>
            <DrawingGroup ClipGeometry="M0,0 V512 H512 V0 H0 Z">
                <DrawingGroup.Transform>
                    <TranslateTransform X="0.010860337875783443" Y="0" />
                </DrawingGroup.Transform>
                <GeometryDrawing Brush="#FF000000" Geometry="F1 M512,512z M0,0z M290.74,93.24L418.76,221.26 140.77,499.25 26.63,511.85C11.35,513.54,-1.56,500.62,0.14,485.34L12.84,371.12 290.74,93.24z M497.94,74.18L437.83,14.07C419.08,-4.68000000000001,388.67,-4.68000000000001,369.92,14.07L313.37,70.62 441.39,198.64 497.94,142.09C516.69,123.33,516.69,92.93,497.94,74.18z" />
            </DrawingGroup>
        </DrawingImage.Drawing>
    </DrawingImage>

    <DrawingImage x:Key="settingsDrawingImage">
        <DrawingImage.Drawing>
            <DrawingGroup ClipGeometry="M0,0 V24 H24 V0 H0 Z">
                <DrawingGroup.Transform>
                    <TranslateTransform X="0" Y="1.3322676295501878E-15" />
                </DrawingGroup.Transform>
                <GeometryDrawing Brush="#FF000000" Geometry="F1 M24,24z M0,0z M22.683,9.394L20.803,9.155C20.648,8.678,20.457,8.218,20.234,7.781L21.395,6.286C21.865,5.681,21.81,4.827,21.273,4.307L19.698,2.732C19.173,2.19,18.319,2.136,17.713,2.605L16.22,3.766C15.783,3.543,15.323,3.352,14.845,3.197L14.606,1.32C14.516,0.566999999999999,13.877,-1.33226762955019E-15,13.12,-1.33226762955019E-15L10.88,-1.33226762955019E-15C10.123,-1.33226762955019E-15,9.48400000000001,0.566999999999999,9.394,1.317L9.155,3.197C8.677,3.352,8.217,3.542,7.78,3.766L6.286,2.605C5.682,2.136,4.828,2.19,4.307,2.727L2.732,4.301C2.19,4.827,2.135,5.681,2.605,6.287L3.766,7.781C3.542,8.218,3.352,8.678,3.197,9.155L1.32,9.394C0.567000000000003,9.484,3.10862446895044E-15,10.123,3.10862446895044E-15,10.88L3.10862446895044E-15,13.12C3.10862446895044E-15,13.877,0.567000000000003,14.516,1.317,14.606L3.197,14.845C3.352,15.322,3.543,15.782,3.766,16.219L2.605,17.714C2.135,18.319,2.19,19.173,2.727,19.693L4.302,21.268C4.828,21.809,5.681,21.863,6.287,21.394L7.781,20.233C8.218,20.457,8.678,20.648,9.155,20.802L9.394,22.678C9.484,23.433,10.123,24,10.88,24L13.12,24C13.877,24,14.516,23.433,14.606,22.683L14.845,20.803C15.322,20.648,15.782,20.457,16.219,20.234L17.714,21.395C18.319,21.865,19.173,21.81,19.693,21.273L21.268,19.698C21.81,19.172,21.865,18.319,21.395,17.713L20.234,16.219C20.458,15.782,20.649,15.322,20.803,14.845L22.679,14.606C23.432,14.516,23.999,13.877,23.999,13.12L23.999,10.88C24,10.123,23.433,9.484,22.683,9.394z M12,17C9.243,17 7,14.757 7,12 7,9.243 9.243,7 12,7 14.757,7 17,9.243 17,12 17,14.757 14.757,17 12,17z" />
            </DrawingGroup>
        </DrawingImage.Drawing>
    </DrawingImage>

    <sys:Double x:Key="NodeRadius">115</sys:Double>
    <sys:Double x:Key="AcceptingMarkRadius">105</sys:Double>
    <sys:Double x:Key="NodeContentSize">80</sys:Double>
    <sys:Double x:Key="NodeContentStringHeight">26</sys:Double>
    <sys:Double x:Key="ChangeHiddingButtonSize">20</sys:Double>
    <sys:Double x:Key="SelfLoopedIndicatorWidth">80</sys:Double>
    <sys:Double x:Key="EdgePointerSize">20</sys:Double>
    
    <Style x:Key="TransitionsEditor" TargetType="ContentControl">
        <Setter Property="ToolTip" Value="{x:Static language:Lang.Editor_TransitionsToolTip}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <ContentControl Grid.Column="0">
                            <ContentControl.Style>
                                <Style TargetType="ContentControl">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Command="{Binding ChangeExpandingCommand}" Background="Transparent" BorderThickness="0" MaxHeight="20">
                                                        <Path Data="F1 M330,330z M0,0z M325.607,304.394L262.128,240.915C300.698,211.88 325.65,175.995 327.375,173.478 330.876,168.368 330.876,161.632 327.375,156.522 324.45,152.253 254.716,51.978 165.004,51.978 139.132,51.978 114.929,60.323 93.5050000000001,72.291L25.607,4.394C19.75,-1.464 10.252,-1.464 4.394,4.394 -1.464,10.252 -1.464,19.749 4.394,25.607L67.872,89.085C29.299,118.12 4.35,154.006 2.625,156.523 -0.875,161.632 -0.875,168.368 2.625,173.478 5.55,177.746 75.275,278.024 165.003,278.024 190.871,278.024 215.072,269.679 236.496,257.71L304.393,325.608C307.323,328.536 311.161,330 315,330 318.839,330 322.678,328.536 325.606,325.606 331.465,319.749 331.465,310.252 325.607,304.394z M165.003,81.977C225.263,81.977 278.411,142.315 296.26,164.999 286.587,177.293 266.555,200.628 240.651,219.438L115.673,94.461C131.079,86.902,147.736,81.977,165.003,81.977z M165.003,248.023C104.718,248.023 51.564,187.659 33.73,164.986 43.381,152.683 63.382,129.328 89.304,110.516L214.294,235.506C198.884,243.084,182.236,248.023,165.003,248.023z"
                                                              Fill="Black" Stretch="Uniform"/>
                                                    </Button>
                                                    <TextBlock Text="ε:" Foreground="Black"/>
                                                    <CheckBox IsChecked="{Binding IsEpsilon}" IsEnabled="{Binding EditionAvailable}"/>
                                                </StackPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsExpanded}" Value="False">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <Button Command="{Binding ChangeExpandingCommand}" Background="Transparent" BorderThickness="0" MaxHeight="20">
                                                            <Image Stretch="Uniform" Source="{StaticResource settingsDrawingImage}"/>
                                                        </Button>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ContentControl.Style>
                        </ContentControl>
                        <TextBox Text="{Binding TransitionTokensString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Top" TextAlignment="Left"
                                 HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="White" Width="30" Grid.Column="1"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- VERTEX CONTROL -->
    <Style TargetType="{x:Type controls:VertexControl}">
        <Setter Property="Background" Value="White"/>
        <Setter Property="BorderBrush" Value="Black"/>
        <Setter Property="VertexShape" Value="Circle"/>
        <Setter Property="ShowLabel" Value="True"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:VertexControl}">
                    <Grid Width="{StaticResource NodeRadius}"  Height="{StaticResource NodeRadius}">
                        <Button MaxHeight="24" Command="{Binding ChangeHidingCommand}" Background="Transparent" BorderThickness="0" 
                                HorizontalAlignment="Right" VerticalAlignment="Top">
                            <Path Data="F1 M330,330z M0,0z M325.607,304.394L262.128,240.915C300.698,211.88 325.65,175.995 327.375,173.478 330.876,168.368 330.876,161.632 327.375,156.522 324.45,152.253 254.716,51.978 165.004,51.978 139.132,51.978 114.929,60.323 93.5050000000001,72.291L25.607,4.394C19.75,-1.464 10.252,-1.464 4.394,4.394 -1.464,10.252 -1.464,19.749 4.394,25.607L67.872,89.085C29.299,118.12 4.35,154.006 2.625,156.523 -0.875,161.632 -0.875,168.368 2.625,173.478 5.55,177.746 75.275,278.024 165.003,278.024 190.871,278.024 215.072,269.679 236.496,257.71L304.393,325.608C307.323,328.536 311.161,330 315,330 318.839,330 322.678,328.536 325.606,325.606 331.465,319.749 331.465,310.252 325.607,304.394z M165.003,81.977C225.263,81.977 278.411,142.315 296.26,164.999 286.587,177.293 266.555,200.628 240.651,219.438L115.673,94.461C131.079,86.902,147.736,81.977,165.003,81.977z M165.003,248.023C104.718,248.023 51.564,187.659 33.73,164.986 43.381,152.683 63.382,129.328 89.304,110.516L214.294,235.506C198.884,243.084,182.236,248.023,165.003,248.023z"
                                   Fill="Black" Stretch="Uniform"/>
                        </Button>
                        <Ellipse x:Name="BackgroundNorm" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="3" Width="{StaticResource NodeRadius}" Height="{StaticResource NodeRadius}"/>
                        <Ellipse Visibility="{Binding FinalMarkVisibility}" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="2" Height="{StaticResource AcceptingMarkRadius}" Width="{StaticResource AcceptingMarkRadius}"/>
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Height="{StaticResource NodeContentSize}">
                            <StackPanel Orientation="Horizontal" Height="{StaticResource NodeContentStringHeight}">
                                <TextBlock Text="{x:Static language:Lang.stateName}" Grid.Column="0" Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         FontWeight="Bold" Foreground="Black" Background="Transparent" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"  Height="{StaticResource NodeContentStringHeight}">
                                <TextBlock Text="{x:Static language:Lang.isAccept}" VerticalAlignment="Center"/>
                                <CheckBox IsChecked="{Binding IsFinal, Mode=TwoWay}" IsEnabled="{Binding EditionAvailable}"
                                          FontWeight="Bold" Foreground="Black" Background="Transparent" VerticalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"  Height="{StaticResource NodeContentStringHeight}">
                                <TextBlock Text="{x:Static language:Lang.isInitial}" VerticalAlignment="Center"/>
                                <CheckBox IsChecked="{Binding IsInitial, Mode=TwoWay}"  IsEnabled="{Binding EditionAvailable}"
                                         FontWeight="Bold" Foreground="Black" Background="Transparent" VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                        <controls:VertexLabelControl x:Name="PART_vertexLabel" LabelPositionSide="Left">
                            <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="20" Height="20" Visibility="{Binding IsInitialMarkVisibility}">
                                <Path.LayoutTransform>
                                    <RotateTransform Angle="180"/>
                                </Path.LayoutTransform>
                            </Path>
                        </controls:VertexLabelControl>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <!-- VERTEX DRAGGING CONTROL -->
        <Setter Property="controls:DragBehaviour.IsDragEnabled" Value="False" />
        <Setter Property="controls:DragBehaviour.UpdateEdgesOnMove" Value="True" />

        <Style.Triggers>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="True">
                <Setter Property="BorderBrush" Value="Gold"/>
                <Setter Property="BorderThickness" Value="3"/>
            </Trigger>
            <DataTrigger Binding="{Binding IsActual}" Value="True">
                <Setter Property="Background" Value="PaleVioletRed"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding IsExpanded}" Value="False">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type controls:VertexControl}">
                            <Grid Width="{StaticResource NodeRadius}" Height="{StaticResource NodeRadius}" >
                                <Button MaxHeight="20" Command="{Binding ChangeHidingCommand}" Background="Transparent" BorderThickness="0"
                                        HorizontalAlignment="Right" VerticalAlignment="Top">
                                    <Image Stretch="Uniform" Source="{StaticResource penDrawingImage}"/>
                                </Button>
                                <Ellipse x:Name="BackgroundNorm" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="3" Width="{StaticResource NodeRadius}" Height="{StaticResource NodeRadius}"/>
                                <Ellipse Visibility="{Binding FinalMarkVisibility}" Stroke="{TemplateBinding BorderBrush}" Fill="{TemplateBinding Background}" StrokeThickness="2" Height="{StaticResource AcceptingMarkRadius}" Width="{StaticResource AcceptingMarkRadius}"/>
                                <TextBlock Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" TextAlignment="Center"
                                         HorizontalAlignment="Center" FontWeight="Bold" Foreground="Black" Background="Transparent" FontSize="30"/>
                                <controls:VertexLabelControl x:Name="PART_vertexLabel" LabelPositionSide="Left" >
                                    <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="{StaticResource EdgePointerSize}" Height="{StaticResource EdgePointerSize}" Visibility="{Binding IsInitialMarkVisibility}">
                                        <Path.LayoutTransform>
                                            <RotateTransform Angle="180"/>
                                        </Path.LayoutTransform>
                                    </Path>
                                </controls:VertexLabelControl>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <!-- EDGE CONTROL -->
    <Style TargetType="{x:Type controls:EdgeControl}">
        <Setter Property="SelfLoopIndicatorOffset" Value="95, 4"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type controls:EdgeControl}">
                    <Grid>
                        <Grid x:Name="PART_SelfLoopedEdge" Width="{StaticResource SelfLoopedIndicatorWidth}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20"/>
                                <RowDefinition Height="50"/>
                            </Grid.RowDefinitions>
                            <Image Stretch="Uniform" Height="70" Grid.RowSpan="2" HorizontalAlignment="Center" Source="{StaticResource selfLoopedIndicator}"/>
                            <ContentControl Grid.Row="0" Style="{StaticResource TransitionsEditor}"/>
                        </Grid>
                        <Path Stroke="Black"
                            StrokeThickness="2" MinWidth="1" MinHeight="1"
                            ToolTip="{TemplateBinding ToolTip}" 
                            x:Name="PART_edgePath"/>
                        <controls:DefaultEdgePointer NeedRotation="true" x:Name="PART_EdgePointerForTarget" >
                            <Path Data="M0,0.5 L1,1 1,0" Fill="Black" Stretch="Uniform" Width="{StaticResource EdgePointerSize}" Height="{StaticResource EdgePointerSize}"/>
                        </controls:DefaultEdgePointer>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>

        <Setter Property="MinWidth" Value="1" />
        <Setter Property="MinHeight" Value="1" />
        <Setter Property="Background" Value="Red" />
        <Setter Property="Foreground" Value="Silver" />
        <Setter Property="Opacity" Value="1" />

        <Setter Property="controls:HighlightBehaviour.IsHighlightEnabled" Value="False"/>

        <Style.Triggers>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="True">
                <Setter Property="Foreground" Value="Gold"/>
                <Setter Property="StrokeThickness" Value="5"/>
            </Trigger>
            <Trigger Property="controls:HighlightBehaviour.Highlighted" Value="False">
                <Setter Property="Foreground" Value="Silver"/>
                <Setter Property="StrokeThickness" Value="2"/>
            </Trigger>
        </Style.Triggers>
    </Style>

    <!-- EDGE LABEL -->
    <Style TargetType="controls:AttachableEdgeLabelControl" >
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="Black"/>

        <!-- Custom label template body -->
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <ContentControl Style="{StaticResource TransitionsEditor}" DataContext="{Binding AttachNode.Edge}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>